<!DOCTYPE html>
<html>
<head>
    <title>Excel Handler</title>
</head>
<body>
    <h2>Excel Handler</h2>

    <form>
        <div class="row row-mb-4">
            <div class="col-md-2">
                <label for="importFile" class="form-label">Upload Excel File</label>
            </div>
            <div class="col-md-4">
                <input name="importFile" id="importFile" type="file" class="form-control" />
            </div>
            <div class="col-md-2">
                <button id="btnUpload" class="btn btn-primary">Upload</button>
            </div>
        </div>
    </form>
    

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script>
        $(document).on("click", "#btnUpload", function () {
            var files = $("#importFile").get(0).files;

            var formData = new FormData();
            formData.append('importFile', files[0]);

            $.ajax({
                url: '@Url.Action("SubmitOrder", "Excel")', // Update this URL to your server endpoint
                data: formData,
                type: 'POST',
                contentType: false,
                processData: false,
                success: function (response) {
                    if (response.result === 1) {
                        alert('Data stored successfully!');
                    } else {
                        alert('Failed to store data!');
                    }
                    $('#importFile').val(''); // Reset the file input field
                },
                error: function () {
                    alert('Failed to upload!');
                }
            });
        });
        

    </script>
</body>
</html>
